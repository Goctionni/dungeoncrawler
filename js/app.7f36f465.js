(function(e){function t(t){for(var a,o,c=t[0],s=t[1],u=t[2],l=0,d=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);p&&p(t);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var s=n[o];0!==r[s]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={app:0},i=[];function o(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-135fd2f0":"5ceb3476","chunk-2d0b1f6a":"27140ac2"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=a);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,c.nc&&s.setAttribute("nonce",c.nc),s.src=o(e);var u=new Error;i=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",u.name="ChunkLoadError",u.type=a,u.request=i,n[1](u)}r[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/dungeoncrawler/",c.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var p=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"01f9":function(e,t,n){"use strict";n("ea84")},"0cfe":function(e,t,n){"use strict";n("ba97")},"20e5":function(e,t,n){},2459:function(e,t,n){"use strict";n("20e5")},"53c9":function(e,t,n){},"5b64":function(e,t,n){},"5c0b":function(e,t,n){"use strict";n("9c0c")},"6a75":function(e,t,n){},"741b":function(e,t,n){"use strict";n("89b3")},"79e2":function(e,t,n){},"89b3":function(e,t,n){},"8c4f":function(e,t,n){},"934e":function(e,t,n){"use strict";n("ae08")},"94a2":function(e,t,n){},9520:function(e,t,n){"use strict";n("8c4f")},"9a9c":function(e,t,n){"use strict";n("f28f")},"9c0c":function(e,t,n){},aa78:function(e,t,n){"use strict";n("5b64")},abc7:function(e,t,n){"use strict";n("94a2")},adb5:function(e,t,n){"use strict";n("53c9")},ae08:function(e,t,n){},ba97:function(e,t,n){},c5fb:function(e,t,n){"use strict";n("79e2")},c958:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app"},[n("div",{staticClass:"appbar"},[n("h1",[e._v("Twine Dungeon Crawler System")]),"project-manager"!==e.state?[n("button",{class:{active:"editor"===e.state},attrs:{type:"button"},domProps:{textContent:e._s("Editor")},on:{click:function(t){e.state="editor"}}}),n("button",{class:{active:"preview"===e.state},attrs:{type:"button"},domProps:{textContent:e._s("Preview")},on:{click:function(t){e.state="preview"}}}),n("span",{staticClass:"separator"}),e.project.hasUnsavedChanges?n("button",{on:{click:function(t){return e.saveProject()}}},[e._v("Save changes")]):n("button",{on:{click:function(t){return e.downloadFiles()}}},[e._v("Download files")]),n("button",{staticClass:"close",attrs:{title:"Close project"},on:{click:function(t){return e.closeProject()}}},[e._v("×")])]:e._e()],2),"project-manager"===e.state?n("ProjectManager",{on:{setProject:function(t){return e.setProject(t)}}}):e._e(),"project-manager"!==e.state?n("MapPicker",{staticClass:"map-picker",attrs:{state:e.state},on:{setMap:function(t){return e.setMap(t)}}}):e._e(),"editor"===e.state?n("Editor",{key:"editor"}):e._e(),"preview"===e.state?n("Preview",{key:"preview",attrs:{show:"preview"===e.state}}):e._e()],1)},i=[],o=n("b85c"),c=n("ade3"),s=n("5530"),u=n("2909"),l=n("1da1"),p=n("d4ec"),d=n("bee2"),v=n("262e"),f=n("2caf"),m=(n("96cf"),n("b0c0"),n("a15b"),n("d81d"),n("99af"),n("a630"),n("3ca3"),n("4de4"),n("d3b7"),n("ddb0"),n("caad"),n("2532"),n("ac1f"),n("5319"),n("25f0"),n("aff5"),n("a9e3"),n("07ac"),n("9ab4")),h=n("1b40"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor"},[n("div",{staticClass:"editor-map"},[n("Map",{attrs:{rows:e.rows,activeTool:e.activeTool,activeTexture:e.activeTexture,mapViewMode:e.mapViewMode,startTile:e.startTile},on:{updateTile:function(t){return e.updateTile(t)},setStart:function(t){return e.setStart(t)}}})],1),n("div",{staticClass:"editor-sidebar"},[n("Sidebar",{attrs:{activeTool:e.activeTool,activeTexture:e.activeTexture,mapViewMode:e.mapViewMode,textures:e.textures,tools:e.tools,mapSize:e.mapSize,startFacing:e.map.start.facing},on:{setTexture:function(t){e.activeTexture=t},setTool:function(t){e.activeTool=t},setMapViewMode:function(t){e.mapViewMode=t},setMapSize:function(t){return e.setMapSize(t)},saveTexture:function(t){return e.saveTexture(t)},removeTexture:function(t){return e.removeTextureByName(t)},setStartFacing:function(t){return e.setStartFacing(t)}}})],1)])},y=[],g=(n("fb6a"),n("7db0"),n("c740"),n("a434"),["floor","north","east","south","west"]),j=function(e,t){return{x:e,y:t,floor:"",north:"",east:"",south:"",west:"",faces:[]}},x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container",style:{"--numRows":e.rows.length,"--numCols":e.rows[0].length}},[n("div",{staticClass:"map",class:e.mapViewMode},e._l(e.rowsWithHover,(function(t,a){return n("div",{key:a,staticClass:"row"},e._l(t,(function(t,r){var i;return n("div",{key:a+","+r,staticClass:"tile",class:(i={},i["tile--start"]=e.isStartTile(t),i),on:{click:function(n){return e.updateTile(t)},mouseenter:function(n){return e.mouseEnter(t)},mouseleave:function(n){return e.mouseLeave(t)},dblclick:function(n){return e.setStart(t)}}},e._l(t.faces,(function(e){return n("div",{key:a+","+r+","+e,class:"face "+e+" texture__"+t[e]})})),0)})),0)})),0)])},w=[],k=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.hover=null,e.keydownHandler=null,e}return Object(d["a"])(n,[{key:"rowsWithHover",get:function(){var e=this.rows,t=this.hover,n=this.activeTool,a=this.activeTexture;return e.map((function(e){return e.map((function(e){var r=Object(s["a"])({},e);return t&&t.x===e.x&&t.y===e.y&&(r[n]=a,r.faces=[n].concat(Object(u["a"])(r.faces.filter((function(e){return e!==n}))))),r}))}))}},{key:"isStartTile",value:function(e){var t,n;return(null===(t=this.startTile)||void 0===t?void 0:t.x)===e.x&&(null===(n=this.startTile)||void 0===n?void 0:n.y)===e.y}},{key:"mouseEnter",value:function(e){this.hover=e}},{key:"mouseLeave",value:function(e){var t,n;(null===(t=this.hover)||void 0===t?void 0:t.x)===e.x&&(null===(n=this.hover)||void 0===n?void 0:n.y)===e.y&&(this.hover=null)}},{key:"updateTile",value:function(e,t,n){t||(t=this.activeTool),this.$emit("updateTile",{tile:e,tool:t,clear:n})}},{key:"setStart",value:function(e){this.$emit("setStart",{x:e.x,y:e.y,facing:"north"})}},{key:"created",value:function(){this.keydownHandler=function(e){this.hover&&("W"===e.key&&this.updateTile(this.hover,"north",!0),"A"===e.key&&this.updateTile(this.hover,"west",!0),"S"===e.key&&this.updateTile(this.hover,"south",!0),"D"===e.key&&this.updateTile(this.hover,"east",!0),"F"===e.key&&this.updateTile(this.hover,"floor",!0),"w"===e.key&&this.updateTile(this.hover,"north"),"a"===e.key&&this.updateTile(this.hover,"west"),"s"===e.key&&this.updateTile(this.hover,"south"),"d"===e.key&&this.updateTile(this.hover,"east"),"f"===e.key&&this.updateTile(this.hover,"floor"),e.preventDefault())}.bind(this),window.addEventListener("keypress",this.keydownHandler)}},{key:"beforeDestroy",value:function(){this.keydownHandler&&window.removeEventListener("keypress",this.keydownHandler)}}]),n}(h["e"]);Object(m["a"])([Object(h["c"])()],k.prototype,"rows",void 0),Object(m["a"])([Object(h["c"])()],k.prototype,"activeTool",void 0),Object(m["a"])([Object(h["c"])()],k.prototype,"activeTexture",void 0),Object(m["a"])([Object(h["c"])()],k.prototype,"mapViewMode",void 0),Object(m["a"])([Object(h["c"])()],k.prototype,"startTile",void 0),k=Object(m["a"])([h["a"]],k);var O=k,M=O,_=(n("01f9"),n("2877")),C=Object(_["a"])(M,x,w,!1,null,"1779e556",null),T=C.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sidebar"},[null!==e.editingTexture?n("TextureEditor",{attrs:{textureName:e.editingTexture},on:{close:function(t){e.editingTexture=null},save:function(t){return e.saveTexture(e.editingTexture,t)}}}):e._e(),n("div",{staticClass:"mapsize"},[n("h2",[e._v("Map size")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.mapSizeXModel,expression:"mapSizeXModel"}],attrs:{type:"number"},domProps:{value:e.mapSizeXModel},on:{input:function(t){t.target.composing||(e.mapSizeXModel=t.target.value)}}}),e._v(" wide")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.mapSizeYModel,expression:"mapSizeYModel"}],attrs:{type:"number"},domProps:{value:e.mapSizeYModel},on:{input:function(t){t.target.composing||(e.mapSizeYModel=t.target.value)}}}),e._v(" high")])]),n("div",{staticClass:"mapViewMode"},[n("h2",[e._v("View type")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.mapViewModeModel,expression:"mapViewModeModel"}],attrs:{type:"radio",value:"individual"},domProps:{checked:e._q(e.mapViewModeModel,"individual")},on:{change:function(t){e.mapViewModeModel="individual"}}}),e._v("Individual 3D")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.mapViewModeModel,expression:"mapViewModeModel"}],attrs:{type:"radio",value:"complete"},domProps:{checked:e._q(e.mapViewModeModel,"complete")},on:{change:function(t){e.mapViewModeModel="complete"}}}),e._v("Complete 3D")])]),n("div",{staticClass:"tools"},[n("div",{staticClass:"flex"},[n("div",[n("h2",[e._v("Face "),n("span",{staticClass:"info-btn",attrs:{"data-tooltip":e.faceTooltip}},[e._v("Info")])]),n("div",{staticClass:"faces"},e._l(e.tools,(function(t){var a;return n("button",{key:t,staticClass:"tool-btn",class:(a={active:t===e.activeTool},a[t]=!0,a),attrs:{type:"button"},on:{click:function(n){return e.setTool(t)}}},[e._v(e._s(e.keyBindings[t]))])})),0)]),n("div",{staticClass:"start-facing"},[n("h2",[e._v("Starting point")]),n("p",[e._v("Double click a tile to start start position")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.startFacingModel,expression:"startFacingModel"}],attrs:{type:"radio",name:"startFacing",value:"north"},domProps:{checked:e._q(e.startFacingModel,"north")},on:{change:function(t){e.startFacingModel="north"}}}),e._v(" Facing north")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.startFacingModel,expression:"startFacingModel"}],attrs:{type:"radio",name:"startFacing",value:"east"},domProps:{checked:e._q(e.startFacingModel,"east")},on:{change:function(t){e.startFacingModel="east"}}}),e._v(" Facing east")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.startFacingModel,expression:"startFacingModel"}],attrs:{type:"radio",name:"startFacing",value:"south"},domProps:{checked:e._q(e.startFacingModel,"south")},on:{change:function(t){e.startFacingModel="south"}}}),e._v(" Facing south")]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.startFacingModel,expression:"startFacingModel"}],attrs:{type:"radio",name:"startFacing",value:"west"},domProps:{checked:e._q(e.startFacingModel,"west")},on:{change:function(t){e.startFacingModel="west"}}}),e._v(" Facing west")])])])]),n("div",{staticClass:"textures"},[n("h2",[e._v("Texture")]),n("div",[n("button",{staticClass:"texture-btn",class:{active:""===e.activeTexture,texture__:!0},attrs:{type:"button"},on:{click:function(t){return e.setTexture("")}}},[e._v("Clear")]),e._l(e.textures,(function(t){var a;return n("button",{key:t,staticClass:"texture-btn",class:(a={active:t===e.activeTexture},a["texture__"+t]=!0,a),attrs:{type:"button"},on:{click:function(n){return e.setTexture(t)}}},[n("button",{staticClass:"edit-texture",on:{click:function(n){return n.preventDefault(),n.stopPropagation(),e.editTexture(t)}}},[e._v("Edit")]),n("button",{staticClass:"remove-texture",on:{click:function(n){return n.preventDefault(),n.stopPropagation(),e.removeTexture(t)}}},[e._v("Remove")])])})),n("button",{staticClass:"texture-btn texture-new",attrs:{type:"button"},on:{click:function(t){return e.newTexture()}}},[e._v("New Texture")])],2)])],1)},E=[],P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dialog",{attrs:{title:e.title},scopedSlots:e._u([{key:"actions",fn:function(){return[n("button",{staticClass:"primary",attrs:{type:"button"},on:{click:function(t){return e.$emit("btn")}}},[e._v("Ok")])]},proxy:!0}])},[e._v(" "+e._s(e.message)+" ")])},F=[],$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"backdrop"},[n("div",{ref:"dialogEl",staticClass:"dialog",attrs:{tabindex:"-1"}},[n("div",{staticClass:"dialog-title"},[e._v(" "+e._s(e.title)+" ")]),n("div",{staticClass:"dialog-body"},[e._t("default")],2),n("div",{staticClass:"dialog-actions"},[e._t("actions")],2)])])},z=[],N=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){return Object(p["a"])(this,n),t.apply(this,arguments)}return Object(d["a"])(n,[{key:"mounted",value:function(){var e=this;if(this.bodyScroll=document.body.scrollTop,this.$refs.dialogEl instanceof HTMLElement){var t=this.$refs.dialogEl;this.captureFocus=function(){t===document.activeElement||t.contains(document.activeElement)||(t.focus(),document.body.scrollTop=e.bodyScroll)},this.captureFocus(),document.body.addEventListener("focusin",this.captureFocus)}}},{key:"beforeDestroy",value:function(){document.body.removeEventListener("focusin",this.captureFocus)}}]),n}(h["e"]);Object(m["a"])([Object(h["c"])()],N.prototype,"title",void 0),N=Object(m["a"])([h["a"]],N);var L=N,A=L,D=(n("adb5"),Object(_["a"])(A,$,z,!1,null,"e742e45a",null)),R=D.exports,V=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){return Object(p["a"])(this,n),t.apply(this,arguments)}return n}(h["e"]);Object(m["a"])([Object(h["c"])()],V.prototype,"title",void 0),Object(m["a"])([Object(h["c"])()],V.prototype,"message",void 0),V=Object(m["a"])([Object(h["a"])({components:{Dialog:R}})],V);var H=V,I=H,Y=Object(_["a"])(I,P,F,!1,null,null,null),G=Y.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dialog",{attrs:{title:e.title},scopedSlots:e._u([{key:"actions",fn:function(){return e._l(e.buttonObjects,(function(t){return n("button",{key:t.text,class:{primary:t.primary},attrs:{type:"button"},domProps:{textContent:e._s(t.text)},on:{click:function(n){return e.$emit("btn",t.text)}}})}))},proxy:!0}])},[e._v(" "+e._s(e.message)+" ")])},X=[],q=(n("2ca0"),function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){return Object(p["a"])(this,n),t.apply(this,arguments)}return Object(d["a"])(n,[{key:"buttonObjects",get:function(){var e;return(null===(e=this.buttons)||void 0===e?void 0:e.map((function(e){return{text:e.startsWith("!")?e.slice(1):e,primary:e.startsWith("!")}})))||[]}}]),n}(h["e"]));Object(m["a"])([Object(h["c"])()],q.prototype,"title",void 0),Object(m["a"])([Object(h["c"])()],q.prototype,"message",void 0),Object(m["a"])([Object(h["c"])({default:["Cancel","!Ok"]})],q.prototype,"buttons",void 0),q=Object(m["a"])([Object(h["a"])({components:{Dialog:R}})],q);var W=q,B=W,J=Object(_["a"])(B,U,X,!1,null,null,null),K=J.exports,Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dialog",{attrs:{title:e.title},scopedSlots:e._u([{key:"actions",fn:function(){return[n("button",{attrs:{type:"button"},on:{click:function(t){return e.$emit("btn",!1)}}},[e._v("Cancel")]),n("button",{staticClass:"primary",attrs:{type:"button"},on:{click:function(t){return e.$emit("btn",e.model)}}},[e._v("Ok")])]},proxy:!0}])},[e._v(" "+e._s(e.message)+" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],domProps:{value:e.model},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("btn",e.model)},input:function(t){t.target.composing||(e.model=t.target.value)}}})])},Q=[],ee=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.model="",e}return Object(d["a"])(n,[{key:"created",value:function(){this.model=this.initialValue}}]),n}(h["e"]);Object(m["a"])([Object(h["c"])()],ee.prototype,"title",void 0),Object(m["a"])([Object(h["c"])()],ee.prototype,"message",void 0),Object(m["a"])([Object(h["c"])()],ee.prototype,"initialValue",void 0),ee=Object(m["a"])([Object(h["a"])({components:{Dialog:R}})],ee);var te=ee,ne=te,ae=(n("aa78"),Object(_["a"])(ne,Z,Q,!1,null,"e73ce90e",null)),re=ae.exports;a["a"].config.productionTip=!1;var ie=function(e,t){var n=document.activeElement;return null===n||void 0===n||n.blur(),new Promise((function(a){var r=document.createElement("div"),i=document.createElement("div");r.appendChild(i),document.body.appendChild(r);var o=new G({propsData:{title:e,message:t}}).$mount(i);o.$on("btn",(function(){o.$destroy(),o.$el.remove(),a(),null===n||void 0===n||n.focus()}))}))},oe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["Cancel","!Ok"],a=document.activeElement;return null===a||void 0===a||a.blur(),new Promise((function(r){var i=document.createElement("div"),o=document.createElement("div");i.appendChild(o),document.body.appendChild(i);var c=new K({propsData:{title:e,message:t,buttons:n}}).$mount(o);c.$on("btn",(function(e){c.$destroy(),c.$el.remove(),r(e),null===a||void 0===a||a.focus()}))}))},ce=function(e,t,n){var a=document.activeElement;return null===a||void 0===a||a.blur(),new Promise((function(r){var i=document.createElement("div"),o=document.createElement("div");i.appendChild(o),document.body.appendChild(i);var c=new re({propsData:{title:e,message:t,initialValue:n}}).$mount(o);c.$on("btn",(function(e){c.$destroy(),c.$el.remove(),r(e),null===a||void 0===a||a.focus()}))}))},se={alert:ie,confirm:oe,prompt:ce},ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"overlay"},[n("div",{staticClass:"dialog",on:{input:function(t){e.error=""}}},[n("div",{staticClass:"dialog-head"},[e._v(" "+e._s(e.titleText)+" "),n("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(t){return e.cancel()}}})]),n("div",{staticClass:"dialog-body"},[e.error?n("div",{staticClass:"error"},[e._v(e._s(e.error))]):e._e(),n("label",{staticClass:"name"},[e._v(" Name: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.nameModel,expression:"nameModel"}],attrs:{type:"text"},domProps:{value:e.nameModel},on:{input:function(t){t.target.composing||(e.nameModel=t.target.value)}}})]),n("h3",[e._v("CSS Properties")]),n("div",{staticClass:"properties"},e._l(e.properties,(function(t,a){return n("div",{key:"cssproperty-"+a,staticClass:"property"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"property.name"}],staticClass:"property-name",attrs:{type:"text"},domProps:{value:t.name},on:{input:function(n){n.target.composing||e.$set(t,"name",n.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"property.value"}],staticClass:"property-value",attrs:{type:"text"},domProps:{value:t.value},on:{input:function(n){n.target.composing||e.$set(t,"value",n.target.value)}}}),n("button",{staticClass:"remove-property",on:{click:function(n){return e.removeProperty(t)}}},[e._v("×")])])})),0),n("button",{staticClass:"add-property",attrs:{type:"button"},on:{click:function(t){return e.addProperty()}}},[e._v("Add new property")])]),n("div",{staticClass:"dialog-footer"},[n("button",{attrs:{type:"button"},on:{click:function(t){return e.cancel()}}},[e._v("Cancel")]),n("button",{attrs:{type:"button"},on:{click:function(t){return e.save()}}},[e._v("Save")])])])])},le=[],pe=(n("498a"),function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.nameModel="",e.error="",e.properties=[],e}return Object(d["a"])(n,[{key:"textureList",get:function(){return this.project.textures}},{key:"titleText",get:function(){return this.textureName?"Edit ".concat(this.textureName):"New texture"}},{key:"removeProperty",value:function(e){this.properties=this.properties.filter((function(t){return t!==e}))}},{key:"addProperty",value:function(){this.properties.push({name:"",value:""})}},{key:"cancel",value:function(){this.$emit("close")}},{key:"save",value:function(){this.nameModel.trim()?this.properties.some((function(e){return!e.name}))?this.error="Cannot have css properties without a name":(this.$emit("save",{name:this.nameModel.trim(),properties:this.properties}),this.$emit("close")):this.error="Texture must have a name"}},{key:"created",value:function(){var e,t=this;this.textureName&&(this.nameModel=this.textureName,this.properties=(null===(e=this.textureList.find((function(e){return e.name===t.textureName})))||void 0===e?void 0:e.properties.map((function(e){return Object(s["a"])({},e)})))||[])}}]),n}(h["e"]));Object(m["a"])([Object(h["c"])()],pe.prototype,"textureName",void 0),Object(m["a"])([Object(h["b"])()],pe.prototype,"project",void 0),pe=Object(m["a"])([h["a"]],pe);var de=pe,ve=de,fe=(n("abc7"),Object(_["a"])(ve,ue,le,!1,null,"78ec3c8e",null)),me=fe.exports,he=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.editingTexture=null,e.wheelHandler=null,e.keyBindings={floor:"f",north:"w",east:"d",south:"s",west:"a"},e.faceTooltip="Select what surface to paint your selected texture on (ie: the north/east/south/west wall of a tile, or the tile's floor).\n\nThe letters on the faces represent keybindings. These do not select a tool but instead apply selected texture on the given face for the hovered tile.",e}return Object(d["a"])(n,[{key:"mapSizeXModel",get:function(){return this.mapSize.x},set:function(e){var t=Object(s["a"])(Object(s["a"])({},this.mapSize),{},{x:e});this.$emit("setMapSize",t)}},{key:"mapSizeYModel",get:function(){return this.mapSize.y},set:function(e){var t=Object(s["a"])(Object(s["a"])({},this.mapSize),{},{y:e});this.$emit("setMapSize",t)}},{key:"mapViewModeModel",get:function(){return this.mapViewMode},set:function(e){this.$emit("setMapViewMode",e)}},{key:"startFacingModel",get:function(){return this.startFacing},set:function(e){this.$emit("setStartFacing",e)}},{key:"setTexture",value:function(e){this.$emit("setTexture",e)}},{key:"setTool",value:function(e){this.$emit("setTool",e)}},{key:"nextTexture",value:function(){var e=this.textures.indexOf(this.activeTexture);e+1>=this.textures.length?this.setTexture(this.textures[0]):this.setTexture(this.textures[e+1])}},{key:"lastTexture",value:function(){var e=this.textures.indexOf(this.activeTexture);e-1<0?this.setTexture(this.textures.slice().pop()):this.setTexture(this.textures[e-1])}},{key:"newTexture",value:function(){this.editingTexture=""}},{key:"editTexture",value:function(e){this.editingTexture=e}},{key:"removeTexture",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,se.confirm("Delete texture","are you sure you want to delete this texture?",["No","!Yes"]);case 2:if(e.t0=e.sent,"Yes"!==e.t0){e.next=5;break}this.$emit("removeTexture",t);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"saveTexture",value:function(e,t){this.$emit("saveTexture",{oldName:e,texture:t})}},{key:"created",value:function(){this.wheelHandler=function(e){e.shiftKey&&(e.preventDefault(),e.deltaY>0?this.nextTexture():e.deltaY<0&&this.lastTexture())}.bind(this),window.addEventListener("wheel",this.wheelHandler,{passive:!1})}},{key:"beforeDestroy",value:function(){this.wheelHandler&&window.removeEventListener("wheel",this.wheelHandler)}}]),n}(h["e"]);Object(m["a"])([Object(h["c"])()],he.prototype,"activeTool",void 0),Object(m["a"])([Object(h["c"])()],he.prototype,"activeTexture",void 0),Object(m["a"])([Object(h["c"])()],he.prototype,"mapViewMode",void 0),Object(m["a"])([Object(h["c"])()],he.prototype,"tools",void 0),Object(m["a"])([Object(h["c"])()],he.prototype,"textures",void 0),Object(m["a"])([Object(h["c"])()],he.prototype,"mapSize",void 0),Object(m["a"])([Object(h["c"])({default:"north"})],he.prototype,"startFacing",void 0),he=Object(m["a"])([Object(h["a"])({components:{TextureEditor:me}})],he);var be=he,ye=be,ge=(n("9520"),Object(_["a"])(ye,S,E,!1,null,"3e5535f3",null)),je=ge.exports,xe=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.mapViewMode="individual",e.tools=g.slice(),e.activeTool="floor",e.activeTexture="",e}return Object(d["a"])(n,[{key:"map",get:function(){var e=this.project,t=this.selectedMap;return e.maps.find((function(e){return e.name===t}))||e.maps[0]}},{key:"mapSize",get:function(){return this.map.size},set:function(e){this.map.size=e,this.project.hasUnsavedChanges=!0}},{key:"startTile",get:function(){return this.map.start},set:function(e){this.map.start=e,this.project.hasUnsavedChanges=!0}},{key:"tiles",get:function(){return this.map.tiles}},{key:"textureList",get:function(){return this.project.textures}},{key:"textures",get:function(){return this.project.textures.map((function(e){return e.name}))}},{key:"rows",get:function(){for(var e=this.mapSize,t=this.tiles,n=[],a=0;a<e.y;a++){for(var r=[],i=0;i<e.x;i++){var o=t["".concat(i,":").concat(a)]||j(i,a);r.push(o)}n.push(r)}return n}},{key:"created",value:function(){Object.assign(window,{GameEditor:this})}},{key:"updateTile",value:function(e){var t=e.tile,n=e.tool,a=e.clear,r=t.x,i=t.y,o="".concat(r,":").concat(i),c=this.tiles[o]||j(r,i);c[n]=a?"":this.activeTexture,c.faces=c.faces.filter((function(e){return e!==n})),this.activeTexture&&c.faces.push(n),c.floor||c.north||c.east||c.south||c.west?this.$set(this.tiles,o,c):this.$delete(this.tiles,o),this.project.hasUnsavedChanges=!0}},{key:"saveTexture",value:function(e){var t=e.oldName,n=e.texture,a=this.textureList.find((function(e){return e.name===t}));a?Object.assign(a,n):this.textureList.push(n),this.project.hasUnsavedChanges=!0}},{key:"removeTextureByName",value:function(e){var t=this.textureList.findIndex((function(t){return t.name===e}));t>=0&&this.textureList.splice(t,1),this.project.hasUnsavedChanges=!0}},{key:"setStart",value:function(e){this.startTile=e,this.project.hasUnsavedChanges=!0}},{key:"setStartFacing",value:function(e){this.setStart(Object(s["a"])(Object(s["a"])({},this.startTile),{},{facing:e}))}},{key:"setMapSize",value:function(e){this.mapSize=e,this.project.hasUnsavedChanges=!0}}]),n}(h["e"]);Object(m["a"])([Object(h["b"])()],xe.prototype,"project",void 0),Object(m["a"])([Object(h["b"])()],xe.prototype,"selectedMap",void 0),xe=Object(m["a"])([Object(h["a"])({components:{Map:T,Sidebar:je}})],xe);var we=xe,ke=we,Oe=(n("741b"),Object(_["a"])(ke,b,y,!1,null,"54c9fc74",null)),Me=Oe.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"preview",style:{"--viewportSize":e.viewportSize+"px"}},[n("GameView",{attrs:{map:e.map,x:e.x,y:e.y,facing:e.facing},on:{actionComplete:function(t){return e.onActionComplete()}}}),n("div",[n("Controls",{attrs:{canMoveForwards:e.canMoveForwards},on:{turnLeft:function(t){return e.turnLeft()},turnRight:function(t){return e.turnRight()},goForwards:function(t){return e.goForwards()}}}),n("div",{staticStyle:{width:"300px",height:"300px","margin-top":"1em",background:"black",padding:"1em"}},[n("MiniMap",{attrs:{faces:e.knownFaces,player:{x:e.x,y:e.y,facing:e.facing}}})],1)],1)],1)},Ce=[],Te=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"minimap",style:(e={},e["--tdc-mm-cell-size"]=t.cellSize+"px",e)},[t.isMounted?t._l(t.rows,(function(e,n){return a("div",{key:"tdc-mm-row-"+n,staticClass:"mm-tile-row"},t._l(e,(function(e,r){return a("div",{key:"tdc-mm-cell-"+r+"-"+n,staticClass:"mm-tile-cell"},[t._l(e,(function(e){return a("div",{key:"tdc-mm-face-"+e+"-"+r+"-"+n,class:"mm-tile-cell-face mm-tile-cell-face--"+e})})),t.player&&t.player.x-t.boundaries.x.min===r&&t.player.y-t.boundaries.y.min===n?a("div",{class:"tdc-mm-player tdc-mm-player--"+t.player.facing}):t._e()],2)})),0)})):t._e()],2)},Se=[],Ee=function(e,t,n){return e.x===t&&e.y===n},Pe=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.size={x:200,y:200},e.isMounted=!1,e}return Object(d["a"])(n,[{key:"boundaries",get:function(){var e,t=this.faces,n=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,r=0,i=0,c=Object(o["a"])(t);try{for(c.s();!(e=c.n()).done;){var s=e.value;n=Math.min(n,s.x),a=Math.min(a,s.y),r=Math.max(r,s.x),i=Math.max(i,s.y)}}catch(u){c.e(u)}finally{c.f()}return{x:{min:n,max:r},y:{min:a,max:i}}}},{key:"cellSize",get:function(){var e=this.boundaries,t=this.size,n=e.y.max-e.y.min+1,a=e.x.max-e.x.min+1,r=Math.floor(t.y/n),i=Math.floor(t.x/a);return Math.min(i,r)}},{key:"rows",get:function(){for(var e=this.boundaries,t=this.faces,n=[],a=function(a){for(var r=[],i=function(e){var n,i=t.filter((function(t){return Ee(t,e,a)})),c=[],s=Object(o["a"])(g);try{var u=function(){var e=n.value;i.some((function(t){return t.facing===e}))&&c.push(e)};for(s.s();!(n=s.n()).done;)u()}catch(l){s.e(l)}finally{s.f()}r.push(c)},c=e.x.min;c<=e.x.max;c++)i(c);n.push(r)},r=e.y.min;r<=e.y.max;r++)a(r);return n}},{key:"updateSize",value:function(){var e=this.$el.parentElement,t=window.getComputedStyle(e),n=parseFloat(t.paddingLeft.replace("px",""))+parseFloat(t.paddingRight.replace("px","")),a=parseFloat(t.paddingTop.replace("px",""))+parseFloat(t.paddingBottom.replace("px",""));this.size.x=e.clientWidth?e.clientWidth-n:200,this.size.y=e.clientHeight?e.clientHeight-a:this.size.x}},{key:"mounted",value:function(){var e=this,t=this.$el.parentElement;this.updateSize(),this.observer=new ResizeObserver((function(){return e.updateSize()})),this.observer.observe(t),this.isMounted=!0}},{key:"beforeDestroy",value:function(){var e;null===(e=this.observer)||void 0===e||e.disconnect()}}]),n}(h["e"]);Object(m["a"])([Object(h["c"])()],Pe.prototype,"faces",void 0),Object(m["a"])([Object(h["c"])()],Pe.prototype,"player",void 0),Pe=Object(m["a"])([h["a"]],Pe);var Fe=Pe,$e=Fe,ze=(n("9a9c"),Object(_["a"])($e,Te,Se,!1,null,"32f576c2",null)),Ne=ze.exports,Le=function(e,t,n,a){var r=e.tiles,i="".concat(t,":").concat(n),o=r[i]||{};return!o[a]},Ae=function(e){switch(e){case"north":return"east";case"east":return"south";case"south":return"west";case"west":return"north"}},De=function(e){switch(e){case"north":return"west";case"east":return"north";case"south":return"east";case"west":return"south"}},Re=function(e){switch(e){case"north":return{x:0,y:-1};case"east":return{x:1,y:0};case"south":return{x:0,y:1};case"west":return{x:-1,y:0}}},Ve=function(e,t){return e.some((function(e){return e.x===t.x&&e.y===t.y&&e.facing===t.facing}))},He=function(e,t,n){var a="".concat(e.x,":").concat(e.y),r=t.tiles[a];if(!r)return n;n=n.slice();var i,c=Object(o["a"])(r.faces);try{for(c.s();!(i=c.n()).done;){var s=i.value;if(r[s]){var u={x:r.x,y:r.y,facing:s};Ve(n,u)||n.push(u)}}}catch(m){c.e(m)}finally{c.f()}if(!r[e.facing]){var l=Re(e.facing),p={x:e.x+l.x,y:e.y+l.y},d="".concat(p.x,":").concat(p.y),v=t.tiles[d];if(null!==v&&void 0!==v&&v.floor){var f={x:p.x,y:p.y,facing:"floor"};Ve(n,f)||n.push(f)}}return n},Ie=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"viewport"},[a("div",{staticClass:"tilt"},[a("div",{staticClass:"player",class:(e={},e["facing-"+t.facing]=!0,e["action-transition"]=t.action,e["transition-"+t.action]=t.action,e),style:"transform: rotateZ("+t.angle+"deg);",on:{transitionend:function(e){return t.onTransitionEnd()}}},[a("div",{staticClass:"map"},t._l(t.viewMap,(function(e,n){return a("div",{key:n,staticClass:"row"},t._l(e,(function(e,r){return a("div",{key:n+","+r,staticClass:"tile"},[t._l(e.faces,(function(t){return[a("div",{key:"viewer_"+n+","+r+","+t,class:"face "+t+" texture__"+e[t]})]}))],2)})),0)})),0)])])])},Ye=[],Ge=["north","east","south","west"],Ue=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.action=null,e.angle=0,e}return Object(d["a"])(n,[{key:"rows",get:function(){for(var e=this.map,t=[],n=0;n<e.size.y;n++){var a=[];t.push(a);for(var r=0;r<e.size.x;r++){var i="".concat(r,":").concat(n),o=e.tiles[i]||j(r,n);a.push(o)}}return t}},{key:"viewMap",get:function(){var e=(null===this||void 0===this?void 0:this.facing)||"north",t=this.action,n=this.rows||[],a=this.x,r=this.y,i=e;"go-forwards"===t?("north"===e&&r++,"south"===e&&r--,"east"===e&&a--,"west"===e&&a++):"turn-right"===t?i=Ae(e):"turn-left"===t&&(i=De(e));var o=this.map.tiles["".concat(a,":").concat(r)];return n.map((function(n){return n.map((function(n){var c=!0,u=[i,e];return u.includes("north")&&n.y<=r&&(c=!1),u.includes("south")&&n.y>=r&&(c=!1),u.includes("east")&&n.x>=a&&(c=!1),u.includes("west")&&n.x<=a&&(c=!1),"go-forwards"===t||c||n.x!==a&&n.y!==r||!o||(o.north&&n.y<r&&n.south&&(n=Object(s["a"])(Object(s["a"])({},n),{},{south:""})),o.south&&n.y>r&&n.north&&(n=Object(s["a"])(Object(s["a"])({},n),{},{north:""})),o.west&&n.x<a&&n.east&&(n=Object(s["a"])(Object(s["a"])({},n),{},{east:""})),o.east&&n.x>a&&n.west&&(n=Object(s["a"])(Object(s["a"])({},n),{},{west:""}))),c?j(n.x,n.y):n}))}))}},{key:"mounted",value:function(){Object.assign(window,{gameview:this}),this.updateCSSVariables()}},{key:"getFacingForAngle",value:function(e){var t=(e%360+360)%360;switch(t){case 0:return"north";case 90:return"west";case 180:return"south";case 270:return"east"}return"north"}},{key:"updateAngle",value:function(e,t){var n=Ge.indexOf(e);if(t){var a=Ge.indexOf(t);if(1===Math.abs(a-n))return n>a?this.turnLeft():this.turnRight();if("north"===e&&"west"===t)return this.turnLeft();if("west"===e&&"north"===t)return this.turnRight()}this.angle=360-90*n}},{key:"turnLeft",value:function(){this.action="turn-left",this.angle-=90}},{key:"turnRight",value:function(){this.action="turn-right",this.angle+=90}},{key:"emitActionComplete",value:function(e,t){null===e&&t&&this.$emit("actionComplete",t)}},{key:"setForwardsAction",value:function(){this.action="go-forwards"}},{key:"updateCSSVariables",value:function(){this.$el&&(this.$el.style.setProperty("--viewportXOffset",this.x.toString()),this.$el.style.setProperty("--viewportYOffset",this.y.toString()))}},{key:"onTransitionEnd",value:function(){this.action=null}}]),n}(h["e"]);Object(m["a"])([Object(h["c"])()],Ue.prototype,"map",void 0),Object(m["a"])([Object(h["c"])()],Ue.prototype,"x",void 0),Object(m["a"])([Object(h["c"])()],Ue.prototype,"y",void 0),Object(m["a"])([Object(h["c"])()],Ue.prototype,"facing",void 0),Object(m["a"])([Object(h["f"])("facing",{immediate:!0})],Ue.prototype,"updateAngle",null),Object(m["a"])([Object(h["f"])("action")],Ue.prototype,"emitActionComplete",null),Object(m["a"])([Object(h["f"])("x"),Object(h["f"])("y")],Ue.prototype,"setForwardsAction",null),Object(m["a"])([Object(h["f"])("x"),Object(h["f"])("y")],Ue.prototype,"updateCSSVariables",null),Ue=Object(m["a"])([h["a"]],Ue);var Xe=Ue,qe=Xe,We=(n("934e"),Object(_["a"])(qe,Ie,Ye,!1,null,"20e00c05",null)),Be=We.exports,Je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"controls"},[n("button",{staticClass:"turn-left",on:{click:function(t){return e.$emit("turnLeft")}}}),n("button",{staticClass:"go-forwards",attrs:{disabled:!e.canMoveForwards},on:{click:function(t){return e.$emit("goForwards")}}}),n("button",{staticClass:"turn-right",on:{click:function(t){return e.$emit("turnRight")}}})])},Ke=[],Ze=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){return Object(p["a"])(this,n),t.apply(this,arguments)}return Object(d["a"])(n,[{key:"created",value:function(){var e=this;this.keyboardListener=function(t){return"w"===t.key&&e.canMoveForwards?e.$emit("goForwards"):"a"===t.key?e.$emit("turnLeft"):"d"===t.key?e.$emit("turnRight"):void 0},document.body.addEventListener("keydown",this.keyboardListener)}},{key:"beforeDestroy",value:function(){document.body.removeEventListener("keydown",this.keyboardListener)}}]),n}(h["e"]);Object(m["a"])([Object(h["c"])()],Ze.prototype,"canMoveForwards",void 0),Ze=Object(m["a"])([h["a"]],Ze);var Qe=Ze,et=Qe,tt=(n("2459"),Object(_["a"])(et,Je,Ke,!1,null,"2f10f450",null)),nt=tt.exports,at=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.facing="north",e.x=0,e.y=0,e.viewportSize=800,e.isActionActive=!1,e.knownFaces=[],e}return Object(d["a"])(n,[{key:"map",get:function(){var e=this.project,t=this.selectedMap;return e.maps.find((function(e){return e.name===t}))||e.maps[0]}},{key:"canMoveForwards",get:function(){return Le(this.map,this.x,this.y,this.facing)}},{key:"updateKnownTiles",value:function(){this.knownFaces=He({x:this.x,y:this.y,facing:this.facing},this.map,this.knownFaces)}},{key:"mounted",value:function(){var e=this;this.updateSize=function(){e.viewportSize=Math.min(800,window.innerHeight-160)},this.updateSize(),window.addEventListener("resize",this.updateSize)}},{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.updateSize)}},{key:"initStartingPosition",value:function(){var e=this.map.start;this.x=e.x,this.y=e.y,this.facing=e.facing}},{key:"onActionComplete",value:function(){this.isActionActive=!1}},{key:"turnRight",value:function(){this.isActionActive||(this.isActionActive=!0,this.facing=Ae(this.facing))}},{key:"turnLeft",value:function(){this.isActionActive||(this.isActionActive=!0,this.facing=De(this.facing))}},{key:"goForwards",value:function(){if(!this.isActionActive&&Le(this.map,this.x,this.y,this.facing)){this.isActionActive=!0;var e=Re(this.facing);this.x+=e.x,this.y+=e.y}}}]),n}(h["e"]);Object(m["a"])([Object(h["b"])()],at.prototype,"project",void 0),Object(m["a"])([Object(h["b"])()],at.prototype,"selectedMap",void 0),Object(m["a"])([Object(h["f"])("x"),Object(h["f"])("y"),Object(h["f"])("facing",{immediate:!0})],at.prototype,"updateKnownTiles",null),Object(m["a"])([Object(h["f"])("map.start",{immediate:!0,deep:!0})],at.prototype,"initStartingPosition",null),at=Object(m["a"])([Object(h["a"])({components:{GameView:Be,Controls:nt,MiniMap:Ne}})],at);var rt=at,it=rt,ot=(n("0cfe"),Object(_["a"])(it,_e,Ce,!1,null,"3c08abb3",null)),ct=ot.exports,st=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"overview"},[n("div",{staticClass:"overview-title"},[e._v("Project Manager")]),n("div",{staticClass:"overview-list"},[e.projects.length?e._l(e.projects,(function(t){return n("button",{key:"pm_project_"+t.guid,staticClass:"project",class:{active:e.projectModel.toLowerCase()===t.name.toLowerCase()},domProps:{textContent:e._s(t.name)},on:{click:function(n){e.projectModel=t.name},dblclick:function(n){e.projectName=t.name,e.openProject()}}})})):n("p",[e._v("No saved projects")])],2),n("div",{staticClass:"overview-input"},[n("label",[e._v(" Project name: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.projectModel,expression:"projectModel"}],attrs:{placeholder:"Enter project name"},domProps:{value:e.projectModel},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault(),e.isExistingProject?e.openProject():e.createNewProject()},input:function(t){t.target.composing||(e.projectModel=t.target.value)}}})])]),n("div",{staticClass:"overview-actions"},[e.projectModel?[e.isExistingProject?n("button",{on:{click:function(t){return e.openProject()}}},[e._v("Open project")]):n("button",{on:{click:function(t){return e.createNewProject()}}},[e._v("Create new project")])]:n("span",{staticClass:"message"},[e._v("Select a project or enter a name")])],2)])])},ut=[],lt=[{name:"floor1",properties:[{name:"background-image",value:"url('./textures/floor_01.png')"},{name:"background-size",value:"contain"},{name:"background-repeat",value:"repeat"}]},{name:"ground",properties:[{name:"background-image",value:"url('./textures/GroundF.png')"},{name:"background-size",value:"contain"},{name:"background-repeat",value:"repeat"}]},{name:"wall1",properties:[{name:"background-image",value:"url('./textures/brks_2.png')"},{name:"background-size",value:"contain"},{name:"background-repeat",value:"repeat"}]},{name:"wall2",properties:[{name:"background-image",value:"url('./textures/brks_1.png')"},{name:"background-size",value:"contain"},{name:"background-repeat",value:"repeat"}]},{name:"wall3",properties:[{name:"background-image",value:"url('./textures/bkred_1.png')"},{name:"background-size",value:"contain"},{name:"background-repeat",value:"repeat"}]},{name:"wall4",properties:[{name:"background-image",value:"url('./textures/brks_8.png')"},{name:"background-size",value:"contain"},{name:"background-repeat",value:"repeat"}]},{name:"metal",properties:[{name:"background-image",value:"url('./textures/wall52_1.png')"},{name:"background-size",value:"contain"},{name:"background-repeat",value:"repeat"}]},{name:"ph1",properties:[{name:"background-color",value:"#f00"}]},{name:"ph2",properties:[{name:"background-color",value:"#0f0"}]},{name:"ph3",properties:[{name:"background-color",value:"#00f"}]},{name:"ph4",properties:[{name:"background-color",value:"#ff0"}]},{name:"ph5",properties:[{name:"background-color",value:"#f0f"}]},{name:"ph6",properties:[{name:"background-color",value:"#0ff"}]},{name:"ph7",properties:[{name:"background-color",value:"#999"}]}],pt=function(){return{name:"",size:{x:7,y:7},start:{x:3,y:3,facing:"north"},tiles:{}}},dt=n("a002"),vt=n.n(dt),ft=vt.a.createInstance({storeName:"tdc-store",description:"Datastore for Twine Dungeon Crawler"}),mt=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.projects=[],e.projectModel="",e}return Object(d["a"])(n,[{key:"isExistingProject",get:function(){var e=this.projects,t=this.projectModel;return e.map((function(e){return e.name.toLowerCase()})).includes(t.toLowerCase())}},{key:"createNewProject",value:function(){var e={guid:Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(36),name:this.projectModel,textures:Object(u["a"])(lt),maps:[Object(s["a"])(Object(s["a"])({},pt()),{},{name:"map 1"})],hasUnsavedChanges:!1};this.$emit("setProject",e)}},{key:"openProject",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,i,c,s,u=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=null===(t=this.projects.find((function(e){return e.name.toLowerCase()===u.projectModel.toLowerCase()})))||void 0===t?void 0:t.guid,n){e.next=3;break}return e.abrupt("return",alert("Error loading project!"));case 3:return e.next=5,ft.getItem("project__".concat(n));case 5:if(a=e.sent,a){e.next=8;break}return e.abrupt("return",alert("Error loading project!"));case 8:r=Object(o["a"])(a.maps);try{for(r.s();!(i=r.n()).done;)c=i.value,s=c.start["direction"],!c.start.facing&&s&&(c.start.facing=s)}catch(l){r.e(l)}finally{r.f()}this.$emit("setProject",a);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ft.getItem("project-list");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:this.projects=e.t0;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(h["e"]);mt=Object(m["a"])([h["a"]],mt);var ht=mt,bt=ht,yt=(n("c5fb"),Object(_["a"])(bt,st,ut,!1,null,"5fd011e4",null)),gt=yt.exports,jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tabs"},[e._l(e.maps,(function(t){return n("button",{key:"select-map__"+t,staticClass:"tab",class:{active:t===e.selectedMap},on:{click:function(n){return e.selectMap(t)}}},[e._v(" "+e._s(t)+" "),e.canEdit?n("div",{staticClass:"actions"},[n("button",{staticClass:"edit",on:{click:function(n){return e.renameMap(t)}}},[e._v("Edit")]),n("button",{staticClass:"delete",on:{click:function(n){return e.removeMap(t)}}},[e._v("Delete")])]):e._e()])})),e.canEdit?n("label",{staticClass:"add-map"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newMapName,expression:"newMapName"}],domProps:{value:e.newMapName},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.addMap())},input:function(t){t.target.composing||(e.newMapName=t.target.value)}}}),n("button",{attrs:{disabled:!e.validMapName},on:{click:function(t){return t.preventDefault(),e.addMap()}}},[e._v("+")])]):e._e()],2)},xt=[],wt=function(e){Object(v["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(p["a"])(this,n),e=t.apply(this,arguments),e.newMapName="",e}return Object(d["a"])(n,[{key:"maps",get:function(){return this.project.maps.map((function(e){return e.name}))}},{key:"validMapName",get:function(){return this.isValidMapName(this.newMapName)}},{key:"canEdit",get:function(){return"editor"===this.state}},{key:"isValidMapName",value:function(e){if(!e)return!1;var t=this.maps.map((function(e){return e.toLowerCase()}));return!t.includes(e.toLowerCase().trim())}},{key:"selectMap",value:function(e){this.$emit("setMap",e)}},{key:"addMap",value:function(){this.validMapName?(this.project.maps.push(Object(s["a"])(Object(s["a"])({},pt()),{},{name:this.newMapName.trim()})),this.newMapName=""):se.alert("Error","This name is either invalid or already in use")}},{key:"renameMap",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,se.prompt("Rename map",'Enter a new name for "'.concat(t,'"'),t);case 2:if(n=e.sent,n!==t){e.next=5;break}return e.abrupt("return");case 5:n&&(a=n.trim().toLowerCase()===t.trim().toLowerCase(),this.isValidMapName(n)||a?(r=n.trim(),i=this.project.maps.find((function(e){return e.name===t})),i.name=r,this.selectedMap===t&&this.selectMap(r)):se.alert("Error","This name is either invalid or already in use"));case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeMap",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,se.confirm("Remove map","Are you sure you want to delete this map?",["No","!Yes"]);case 2:if(e.t0=e.sent,"Yes"!==e.t0){e.next=7;break}this.maps.length<=1&&(n=this.generateMapName(),this.project.maps.push(Object(s["a"])(Object(s["a"])({},pt()),{},{name:n.trim()}))),this.selectMap(this.maps.find((function(e){return e!==t}))),this.project.maps=this.project.maps.filter((function(e){return e.name!==t}));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"generateMapName",value:function(){for(var e=1;;e++)if(!this.maps.includes("Map ".concat(e)))return"Map ".concat(e)}}]),n}(h["e"]);Object(m["a"])([Object(h["b"])()],wt.prototype,"project",void 0),Object(m["a"])([Object(h["b"])()],wt.prototype,"selectedMap",void 0),Object(m["a"])([Object(h["c"])()],wt.prototype,"state",void 0),wt=Object(m["a"])([h["a"]],wt);var kt=wt,Ot=kt,Mt=(n("e5e4"),Object(_["a"])(Ot,jt,xt,!1,null,"5a5bbb81",null)),_t=Mt.exports,Ct=(n("1276"),n("820e"),function(e){return e.textures.filter((function(t){return e.maps.some((function(e){return Object.values(e.tiles).some((function(e){return[e.north,e.east,e.south,e.west,e.floor].includes(t.name)}))}))}))}),Tt=function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.split(/[;{}]/),a=n.map((function(e){var t,n=null===(t=e.split("url(")[1])||void 0===t?void 0:t.trim();return n?(n=n.split(")")[0].trim(),n=n.replace(/['"]/g,""),n):""})).filter(Boolean),r=a.map(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){return e.blob()}));case 2:return n=e.sent,e.abrupt("return",{blob:n,filename:t.split("/").pop(),url:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.allSettled(r);case 5:return i=e.sent,e.abrupt("return",i.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),St=function(e){Object(v["a"])(a,e);var t=Object(f["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.apply(this,arguments),e.state="project-manager",e.project=null,e.selectedMap="",e}return Object(d["a"])(a,[{key:"textureCSS",get:function(){return this.project?this.generateTextureCSS(this.project.textures):""}},{key:"initDefaultMap",value:function(){var e;this.selectedMap=(null===(e=this.project)||void 0===e?void 0:e.maps[0].name)||""}},{key:"generateTextureCSS",value:function(e){return e.map((function(e){var t=e.properties.map((function(e){var t=e.name,n=e.value;return"  ".concat(t,": ").concat(n,";")})).join("\n");return".texture__".concat(e.name," {\n").concat(t,"\n}")})).join("\n\n")||""}},{key:"initStyleTarget",value:function(){var e=Array.from(document.head.querySelectorAll("style[data-tdc]"));while(e.length){var t;null===(t=e.pop())||void 0===t||t.remove()}this.styleElement=document.createElement("style"),this.styleElement.setAttribute("data-tdc",""),document.head.appendChild(this.styleElement)}},{key:"setMap",value:function(e){this.selectedMap=e}},{key:"setProject",value:function(e){this.project=e,this.state="editor"}},{key:"updateDomTextureCSS",value:function(){this.styleElement.innerHTML=this.textureCSS}},{key:"saveProject",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.project){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ft.getItem("project-list");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:t=e.t0,n=t.filter((function(e){var t;return e.guid!==(null===(t=a.project)||void 0===t?void 0:t.guid)})),this.project.hasUnsavedChanges=!1,ft.setItem("project-list",[{name:this.project.name,guid:this.project.guid}].concat(Object(u["a"])(n))),ft.setItem("project__".concat(this.project.guid),this.project);case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"downloadFiles",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,r,i,l,p,d,v,f,m,h,b,y,g,j,x,w,k,O,M,_,C;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.project){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e("chunk-135fd2f0").then(n.t.bind(null,"c4e3",7));case 4:return t=e.sent.default,a=new t,r=this.project.maps.reduce((function(e,t){return Object(s["a"])(Object(s["a"])({},e),{},Object(c["a"])({},t.name,t))}),{}),i="setup.tdc = { viewportSize: '800px', maps: ".concat(JSON.stringify(r)," };\n"),a.file("tdc/tdc-setup.js",i),l=Ct(this.project),p=this.generateTextureCSS(l),e.next=13,Tt(p);case 13:d=e.sent,v=Object(o["a"])(d);try{for(v.s();!(f=v.n()).done;){m=f.value,h="textures/".concat(m.filename),m.url.includes(h)&&(h=h.replace("textures/","textures/".concat(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(36),"_"))),a.file(h,m.blob);while(p.includes(m.url))p=p.replace(m.url,h)}}catch(T){v.e(T)}finally{v.f()}return a.file("tdc/tdc-textures.css",p),a.file("tdc/tdc-nofade.css",".passage.tdc { transition-property: none; }"),e.next=20,fetch("//raw.githubusercontent.com/Goctionni/dungeoncrawler/viewerjs/tdc-plugin.js");case 20:return b=e.sent,e.next=23,b.text();case 23:return y=e.sent,a.file("tdc/tdc-plugin.js",y),e.next=27,fetch("//raw.githubusercontent.com/Goctionni/dungeoncrawler/viewerjs/tdc-macro.js");case 27:return g=e.sent,e.next=30,g.text();case 30:return j=e.sent,a.file("tdc/tdc-macro.js",j),e.next=34,fetch("//raw.githubusercontent.com/Goctionni/dungeoncrawler/viewerjs/tdc-template.tw");case 34:return x=e.sent,e.next=37,x.text();case 37:w=e.sent,a.file("tdc/tdc-template.tw",w),k=Object(o["a"])(this.project.maps);try{for(M=function(){var e=O.value,t=Object.values(e.tiles).map((function(t){return":: tdc-".concat(e.name," (").concat(t.x,",").concat(t.y,") [tdc]\n\n<<DungeonCrawler '").concat(e.name,"' ").concat(t.x," ").concat(t.y," $tdcFacing>><</DungeonCrawler>>\n")})),n=":: tdc-".concat(e.name," [tdc]\n\n<<DungeonCrawler '").concat(e.name,"'>><</DungeonCrawler>>\n")+'<<done>><<replace ".tdc-description">>You enter the dungeon... (You can use this to place text into the sample UI)<</replace>><</done>>';a.file("tdc-passages/".concat(e.name,".tw"),[n].concat(Object(u["a"])(t)).join("\n\n"))},k.s();!(O=k.n()).done;)M()}catch(T){k.e(T)}finally{k.f()}return e.next=43,a.generateAsync({type:"blob"});case 43:return _=e.sent,e.next=46,n.e("chunk-2d0b1f6a").then(n.t.bind(null,"21a6",7));case 46:C=e.sent.saveAs,C(_,"tdc_".concat(this.project.name,".zip"));case 48:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"closeProject",value:function(){this.project=null,this.state="project-manager"}},{key:"created",value:function(){this.initStyleTarget()}}]),a}(h["e"]);Object(m["a"])([Object(h["d"])()],St.prototype,"project",void 0),Object(m["a"])([Object(h["d"])()],St.prototype,"selectedMap",void 0),Object(m["a"])([Object(h["f"])("project",{immediate:!0})],St.prototype,"initDefaultMap",null),Object(m["a"])([Object(h["f"])("textureCSS")],St.prototype,"updateDomTextureCSS",null),St=Object(m["a"])([Object(h["a"])({components:{Editor:Me,Preview:ct,ProjectManager:gt,MapPicker:_t}})],St);var Et=St,Pt=Et,Ft=(n("5c0b"),n("f710"),Object(_["a"])(Pt,r,i,!1,null,"4e54db80",null)),$t=Ft.exports;a["a"].config.productionTip=!1;var zt=(new $t).$mount("#app");Object.assign(window,{app:zt})},e5e4:function(e,t,n){"use strict";n("c958")},ea84:function(e,t,n){},f28f:function(e,t,n){},f710:function(e,t,n){"use strict";n("6a75")}});
//# sourceMappingURL=app.7f36f465.js.map